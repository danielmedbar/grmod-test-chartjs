<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
</head>
<body>
  <h1>Hola Edu !!!</h1>
  <h2>Base model data</h2>
  <div contenteditable="True">
    {{ base_model|safe }}
  </div>
  <h2>Initiative model data</h2>
  <div contenteditable="True">
    {{ initiative_model|safe }}
  </div>
  <br>
  <div>
    <canvas id="line-plot" width="1000" height="500"></canvas>
  </div>


  <script>
    var tableInitiative = document.querySelector('#initiative_model_data').getElementsByTagName('td');
    var tableInitiativeArr = [];

    function updateTableInitiativeArr() {
      for (var i = 0; i < tableInitiative.length; i++){
        tableInitiativeArr.push(tableInitiative[i].innerHTML)
      };
    };

    for (var i = 0; i < tableInitiative.length; i++){
      tableInitiativeArr.push(tableInitiative[i].innerHTML)
    };
    
    console.log(tableInitiative);
    console.log(tableInitiativeArr);

    function addData(chart, data, datasetIndex) {
      chart.data.datasets[datasetIndex].data = data;
      chart.update();
    };



    var config_line = {
      type: 'line',
      fill: false,
      data: {
        datasets: [{
          data: {{ data|safe }},
          backgroundColor: ['rgba(255, 99, 132, 0.2)'],
          label: 'Base model',
          },{
          data: tableInitiativeArr,
          backgroundColor: ['rgba(54, 162, 235, 0.2)'],
          label: 'Initiative model'
          }
        ],
      labels: {{ labels|safe }}
      },
      options: {
        legend:{
          display: true,
        },
        responsive: false
      }
    };

    window.onload = function() {
      var ctx_line = document.getElementById('line-plot').getContext('2d');
      window.myLine = new Chart(ctx_line, config_line);
    };

    document.querySelector('#initiative_model_data').onchange = function(){
      updateTableInitiativeArr();
      addData(chart=window.myLine, data=[0], datasetIndex=0);
    };
    console.log(window.myLine.data);
    
  </script>
</body>
</html>